<!DOCTYPE html>
<html lang="en">
  <head>
    <title>JBoss Tools</title>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="description">
    <meta content="" name="author">
    <link href="http://static.jboss.org/theme/css/bootstrap-community/2.3.1.3/bootstrap-community.css" media="screen" rel="stylesheet">
    <!-- IE 6-8 support of HTML 5 elements -->
    <!--[if lt IE 9]>
      <script src="http://static.jboss.org/theme/js/libs/html5/pre3.6/html5.min.js"></script>
    <![endif]-->
    <!-- Defines the project favicon. Change these URLs to your specific project folder on static.jboss.org. -->
    <link href="http://static.jboss.org/images/tools/favicon.ico" rel="shortcut icon">
    <link href="http://static.jboss.org/images/tools/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144">
    <link href="http://static.jboss.org/images/tools/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114">
    <link href="http://static.jboss.org/images/tools/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72">
    <link href="http://static.jboss.org/images/tools/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed">
    <link href="http://xcoulon.github.com/jbosstools-website/stylesheets/jbt-styles.css" rel="stylesheet" type="text/css">
    <link href="http://xcoulon.github.com/jbosstools-website/fonts/font-awesome/font-awesome.css" media="screen, projection" rel="stylesheet" type="text/css">
    <!-- Defines the project banner. Change these URLs to your specific project folder on static.jboss.org -->
    <!--
      <style>
        @media (min-width: 980px) {
          .banner { background-image: url(http://static.jboss.org/images/tools/tools-banner-1180px.png); height: 110px;  }
        }
        @media (max-width: 979px) {
          .banner { background-image: url(http://static.jboss.org/images/tools/tools-logo.png); background-repeat:no-repeat; height: 60px; }
        }
        @media (max-width: 650px) {
          .banner { width: 200px; margin: 0px auto; }
        }
      </style>
    -->
    <style>
      .banner { background-image: url(http://static.jboss.org/images/tools/tools-banner-1180px.png); height: 110px;  }
    </style>
    <script src="http://static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.js"></script>
  </head>
  <body>
    <!-- begin accessibility skip to top -->
    <ul class="visuallyhidden" id="top">
      <li>
        <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a>
      </li>
      <li>
        <a accesskey="c" href="#page" title="Skip to content">Skip to content</a>
      </li>
    </ul>
    <div class="container" id="content">
      <div class="dropup">
        <a class="tabnav-closed" href="https://www.jboss.org" id="tab">Red Hat</a>
        <script>
          window.addEventListener('load', function() { renderTabzilla("JBoss Tools","tools") }, false);
        </script>
      </div>
      <div class="banner">
        <a href="#"></a>
      </div>
      <div class="navbar navbar-inverse" id="navbar-fix">
        <div class="navbar-inner">
          <div class="container">
            <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>
            <div class="nav-collapse collapse">
              <ul class="nav">
                <li id="home"><a href="http://xcoulon.github.com/jbosstools-website/">Home</a></li>
                <li id="downloads"><a href="http://xcoulon.github.com/jbosstools-website/downloads/">Downloads</a></li>
                <li class="dropdown" id="docs"><a class="dropdown-toggle" data-toggle="dropdown" href="#">Docs <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="http://xcoulon.github.com/jbosstools-website/features">Features</a></li>
                  <li><a href="http://xcoulon.github.com/jbosstools-website/whatsnew">What's New</a></li>
                  <li><a href="http://xcoulon.github.com/jbosstools-website/guides/videos.html">Video Tutorials</a></li>
                  <li><a href="http://docs.jboss.org/tools/4.1.0.Final/">Reference Guides</a></li>
                </ul></li>
                <li class="dropdown" id="community">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="#">Community <b class="caret"></b></a>
                  <ul class="dropdown-menu">
                    <li><a href="http://xcoulon.github.com/jbosstools-website/contribute.html">Contribute</a></li>
                    <li><a href="http://www.jboss.org/community/docs/DOC-10794">Wiki</a></li>
                    <li><a href="http://community.jboss.org/community/tools?view=discussions">User Forum</a></li>
                    <li><a href="https://lists.jboss.org/mailman/listinfo/jbosstools-dev">Mailing Lists</a></li>
                    <li><a href="irc://irc.freenode.org/jbosstools">Chat</a></li>
                    <li id="blog"><a href="../blog">Blog</a></li>
                  </ul>
                </li>
                <li id="issuetracker"><a href="https://issues.jboss.org/browse/JBIDE">Issues</a></li>
                <li id="sourcecode"><a href="https://github.com/jbosstools">Source Code</a></li>
                <li id="build"><a href="http://hudson.jboss.org/hudson/view/JBossTools/view/JBossTools_Trunk/">Build</a></li>
                <li class="dropdown">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="#">Follow Us <b class="caret"></b></a>
                  <ul class="dropdown-menu projectsocialmedia">
                    <li><a href="http://twitter.com/jbosstools"><img src="http://static.jboss.org/theme/images/common/socialmedia_icon40_twitter.png"></a></li>
                    <li><a href="https://plus.google.com/109915195368578219327"><img src="http://static.jboss.org/theme/images/common/socialmedia_icon40_googleplus.png"></a></li>
                  </ul>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <!-- activate the tab by adding the 'active' class -->
      <script>
        document.getElementById("community").className += " active";
      </script>
      <div id="content-wrapper">
        <div class="posts-header">
          <h1>Articles tagged with "Java"</h1>
          <div class='breadcrumb'><a class='breadcrumb_anchor ' href='http://xcoulon.github.com/jbosstools-website/index.html'
                  >Home</a> / <a class='breadcrumb_anchor ' href='http://xcoulon.github.com/jbosstools-website/blog/index.html'
                  >Blog</a> / <a class='breadcrumb_anchor active' href='http://xcoulon.github.com/jbosstools-website/blog/tags/java/index.html'
                  >Blog</a></div>
        </div>
        <div class="row-fluid">
          <div class="span12 posts" id="core-page">
            <div class="post">
              <div class="title-wrapper">
                <img class="img-polaroid" src="https://community.jboss.org/people/adietish/avatar/64.png">
                <div class="title">
                  <h3>
                    <a href="../../2012/08/24/show-domain-info-openshift-java-client-in-a-nutshell.html">show-domain-info: openshift-java-client in a nutshell</a>
                  </h3>
                  <div class="author">
                    <!-- there is only one author per post but the author splitter adds an array here -->
                    posted by
                    <strong>Andr√© Dietisheim</strong>
                    on
                    <strong>Aug 24, 2012.</strong>
                    <a class="label label-info" href="../openshift">OpenShift</a>
                    <a class="label label-info" href=".">Java</a>
                  </div>
                </div>
              </div>
              <div class="body">
                
                <p>At JBoss Tools we created a java client that allows you to talk to the <a href="https://openshift.redhat.com/app/">OpenShift</a> PaaS: <a href="https://github.com/openshift/openshift-java-client">openshift-java-client</a>. The library is already used in the <a href="https://community.jboss.org/en/tools/blog/tags/openshift">OpenShift tooling</a> in <a href="http://www.jboss.org/tools/">JBoss Tools</a>, the <a href="https://github.com/forge/plugin-openshift-express/">Forge plugin</a> and <a href="http://www.appcelerator.com/platform/titanium-studio">Appcelerator Titanium Studio</a>'s tooling for OpenShift. This blog post will show you how to use okthis API in your very own java programs. We'll develop a command line tool that displays informations equivalent to what you get when running <strong>rhc domain show</strong> with the <a href="href=&quot;https://openshift.redhat.com/community/developers/install-the-client-tools">OpenShift command line tools</a>: it displays basic informations about your user.</p>
                
                <pre><code>================&#x000A;        Namespace: andre&#x000A;          RHLogin: andre.dietisheim@redhat.com&#x000A;        &#x000A;        Application Info&#x000A;        ================&#x000A;        kitchensink&#x000A;            Framework: jbossas-7&#x000A;             Creation: 2012-08-10T11:24:13-04:00&#x000A;                 UUID: 8ad0d94f39aa4295a0049de8b8b5ef55&#x000A;              Git URL: ssh:&lt;SOMEID&gt;@kitchensink-andre.rhcloud.com/~/git/kitchensink.git/&#x000A;           Public URL: http://kitchensink-andre.rhcloud.com/&#x000A;        &#x000A;         Embedded: &#x000A;             jenkins-client-1.4 - Job URL: https://jenk-andre.rhcloud.com/job/kitchensink-build/&#x000A;        </code></pre>
                
                <p>You'll find the sourcecode for this example at github: [https://github.com/adietish/show-domain-info] (https://github.com/adietish/show-domain-info). All the code that is shown in this blog is contained within the <a href="https://github.com/adietish/show-domain-info/blob/master/src/main/java/com/redhat/openshift/examples/domaininfo/Main.java">Main</a> class.</p>
                
                <p>If you want to dig futher, you'll get a more complete example that includes jenkins in <a href="https://community.jboss.org/docs/DOC-19828">this wiki article</a>.</p>
                
                <h1 id="openshift-java-client-20">Openshift-java-client 2.0</h1>
                
                <p>The <a href="https://github.com/openshift/openshift-java-client">openshift-java-client</a> is a java library that allows java programs to talk to the OpenShift PaaS. It talks to the new OpenShift <a href="https://openshift.redhat.com/community/sites/default/files/documents/OpenShift-2.0-REST_API_Guide-en-US.pdf">RESTful service</a> and allows users to create, modify and destroy OpenShift resources: domains, applications, cartridges, etc. It is hosted on github at <a href="https://github.com/openshift/openshift-java-client">https://github.com/openshift/openshift-java-client</a> and is available under the <a href="http://www.eclipse.org/legal/epl-v10.html">Eclipse Public License</a>.</p>
                
                <p><strong>Note:</strong>
                Openshift-java-client 1.x was talking to the legacy service in OpenShift. 2.0 switched to the new RESTful service.
                The legacy service is not maintained any more and will fade away at some point. Users of the 1.x client should migrate to the 2.0 client.
                The migration should be pretty much without hassles. Even though 2.0 is a complete rewrite, the API stayed pretty much the same/very close.</p>
                
                <h1 id="requirements">Requirements</h1>
                
                <ul>
                  <li>You need an account on OpenShift. (If you have no account yet, you'd have to <a href="https://openshift.redhat.com/app/account/new">signup</a> first)</li>
                  <li>Make sure you have an OpenShift domain and some applications (to get some meaningful output)</li>
                </ul>
                
                <h1 id="launch-parameters">Launch Parameters</h1>
                
                <p>To keep the implemenation simple, the program we're about to write, only accept 2 parameters on the command line:</p>
                
                <ol>
                  <li>username</li>
                  <li>password</li>
                </ol>
                
                <p>Launching the program with maven would look like this:</p>
                
                <pre><code>mvn test -Dusername=&lt;username&gt; -Dpassword=&lt;password&gt;&#x000A;        </code></pre>
                
                <h1 id="project-setup">Project Setup</h1>
                
                <p>We have to make sure that we have the <a href="https://github.com/openshift/openshift-java-client">openshift-java-client</a> available on our classpath. The client library is available at <a href="&quot;https://github.com/openshift/openshift-java-client">https://github.com/openshift/openshift-java-client</a>. You could clone the repo and build your own jar by telling maven to "mvn clean package". But even simpler is to add it as dependency to your <a href="&quot;https://github.com/adietish/show-domain-info/blob/master/pom.xml#L8">pom.xml</a>, since the client library is also available from central as maven artifact:</p>
                
                <pre><code>&lt;dependency&gt;&#x000A;          &lt;groupId&gt;com.openshift&lt;/groupId&gt;&#x000A;          &lt;artifactId&gt;openshift-java-client&lt;/artifactId&gt;&#x000A;          &lt;version&gt;2.0.0&lt;/version&gt;&#x000A;        &lt;/dependency&gt;&#x000A;        </code></pre>
                
                <h1 id="connect-to-openshift">Connect to OpenShift</h1>
                
                <p>After we did some basic command line parameter parsing (that we skipped here on puropose) we'd have to get in touch with the OpenShift PaaS. Using the <a href="https://github.com/openshift/openshift-java-client">openshift-java-client</a> you'd tell the <a href="https://github.com/adietish/openshift-java-client/blob/master/src/main/java/com/openshift/client/OpenShiftConnectionFactory.java">OpenShiftConnectionFactory</a> to create a connection for you. To create this connection you'll have to provide some parameters:</p>
                
                <h3 id="server-url">Server url</h3>
                
                <p>First of all you need to give it the url of the OpenShift PaaS. You may either hard code it or ask the OpenShift configuration for it:</p>
                
                <pre><code>new OpenShiftConfiguration().getLibraServer()&#x000A;        </code></pre>
                
                <p>The OpenShiftConfiguration class parses the OpenShift <a href="http://docs.redhat.com/docs/en-US/OpenShift/2.0/html/Getting_Started_Guide/sect-Getting_Started_Guide-OpenShift_Client_Tools-Configuring_Client_Tools.html">configuration files</a> you may have on your machine (~/.openshift/express.conf, C:/Documents and Settings/user/.openshift/express.conf, etc.). Those usually get created once you installed the <a href="http://docs.redhat.com/docs/en-US/OpenShift/2.0/html/User_Guide/chap-User_Guide-OpenShift_Command_Line_Interface.html">rhc command line</a> tools. In case you don't have any configuration yet, <a href="href=&quot;https://github.com/adietish/openshift-java-client/blob/master/src/main/java/com/openshift/client/configuration/OpenShiftConfiguration.java">OpenShiftConfiguration</a> holds some meaningful <a href="https://github.com/openshift/openshift-java-client/blob/master/src/main/java/com/openshift/client/configuration/DefaultConfiguration.java">defaults</a> and points to <a href="http://openshift.redhat.com">http://openshift.redhat.com</a>. On the other hand, our configuration class also allows you to override settings by putting them to the <a href="https://github.com/openshift/openshift-java-client/blob/master/src/main/java/com/openshift/client/configuration/SystemProperties.java">system configuration</a> as you would do if you want to switch to the OpenShift <a href="https://openshift.redhat.com/community/wiki/getting-started-with-openshift-origin-livecd">LiveCD</a> temporarly. You would then simply add the following to the command line when launching the java virtual machine:</p>
                
                <pre><code>-Dlibra_server=127.0.0.1&#x000A;        </code></pre>
                
                <h3 id="client-id">Client id</h3>
                
                <p>The connection factory also requires you to provide your very own client id. This client id is used when the openshift-java-client talks to the OpenShift REST service. It'll get included in the user-agent string that tells OpenShift what client it is talking to. We use the name of our example, <strong>show-domain-info</strong>.</p>
                
                <h3 id="username-and-password">Username and Password</h3>
                
                <p>Last but not least, you also have to give it your OpenShift credentials, the ones we got from the command-line.</p>
                
                <pre><code>String openshiftServer = new OpenShiftConfiguration().getLibraServer();&#x000A;        IOpenShiftConnection connection = new OpenShiftConnectionFactory()&#x000A;          .getConnection("show-domain-info", "myuser", "mypassword", openshiftServer);&#x000A;        </code></pre>
                
                <p>Once you have your connection you can get a <a href="https://github.com/openshift/openshift-java-client/blob/master/src/main/java/com/openshift/client/IUser.java">IUser</a> instance which will allow you to create your domain and applications:</p>
                
                <pre><code>IUser user = connection.getUser();&#x000A;        </code></pre>
                
                <p>The first information block involves basic user informations. The username is available from your <a href="https://github.com/adietish/openshift-java-client/blob/master/src/main/java/com/openshift/client/IUser.java">IUser</a> instance:</p>
                
                <pre><code>System.out.println("RHLogin:\t" + user.getRhlogin());&#x000A;        </code></pre>
                
                <p>The other value that we want to display, the domain namespace, is accessible from your OpenShift <a href="https://github.com/adietish/openshift-java-client/blob/master/src/main/java/com/openshift/client/IDomain.java">IDomain</a>. We'll get it from the the user instance and print its id (namespace).</p>
                
                <pre><code>IDomain domain = user.getDefaultDomain();&#x000A;        System.out.println("Namespace:\t" + domain.getId());&#x000A;        </code></pre>
                
                <h1 id="print-the-application-infos">Print the Application Infos</h1>
                
                <p>The second portion printed by <strong>rhc domain show</strong> is reporting your users applications. All OpenShift applications are held in a list within your domain. We simply get the list and iterate over it's entries:</p>
                
                <pre><code>for (IApplication application : domain.getApplications()) {&#x000A;        </code></pre>
                
                <p>The required values - name, framework, creation time etc. - are now available within each <a href="https://github.com/adietish/openshift-java-client/blob/master/src/main/java/com/openshift/client/IApplication.java">IApplication</a> instance:</p>
                
                <pre><code>System.out.println(application.getName());&#x000A;        System.out.println("\tFramework:\t" + application.getCartridge().getName());&#x000A;        System.out.println("\tCreation:\t" + application.getCreationTime());&#x000A;        System.out.println("\tUUID:\t\t" + application.getUUID());&#x000A;        System.out.println("\tGit URL:\t" + application.getGitUrl());&#x000A;        System.out.println("\tPublic URL:\t" + application.getApplicationUrl() + "\n");&#x000A;        </code></pre>
                
                <p>An application may have several cartridges embedded (MySql, Postgres, Jenkins etc.). These cartridges are reported by by the application. We get the list of cartridges and inspect at each of them:</p>
                
                <pre><code>for(IEmbeddedCartridge cartridge : application.getEmbeddedCartridges()) {&#x000A;        </code></pre>
                
                <p>We then want to know bout a cartridge's <a href="https://github.com/adietish/openshift-java-client/blob/master/src/main/java/com/openshift/client/IEmbeddedCartridge.java">IEmbeddableCartridge</a>, name and url:</p>
                
                <pre><code>System.out.println("\t" + cartridge.getName() + " - URL:" + cartridge.getUrl());&#x000A;        </code></pre>
                
                <p>That is it - you now have an app that can talk to OpenShift via its <a href="https://openshift.redhat.com/community/sites/default/files/documents/OpenShift-2.0-REST_API_Guide-en-US.pdf">REST API</a>. If you want to do more we also have this <a href="https://community.jboss.org/docs/DOC-19828">article</a> that shows how to perform actual operations against your OpenShift applications. </p>
                
                <p>Hope you enjoy it and let us know what you build with it!</p>
              </div>
              <hr>
            </div>
          </div>
          <!--
            <div class="span3">
              <div class="menu-level3">
                <h4>Recent Posts</h4>
                <ul>
                  <li>
                    <a href="../../2013/07/23/jbosstools_41_and_Red_Hat_Developer_Studio_7_go_GA.html">JBoss Tools 4.1 and Red Hat JBoss Developer Studio 7 go GA</a>
                  </li>
                  <li>
                    <a href="../../2012/08/24/show-domain-info-openshift-java-client-in-a-nutshell.html">show-domain-info: openshift-java-client in a nutshell</a>
                  </li>
                </ul>
              </div>
            </div>
          -->
        </div>
        <div class="row-fluid">
          <div class="span12 center">
            <hr>
            <div class="pagination">
              <ul>
                <li class="disabled">
                  <a href="#">&laquo;</a>
                </li>
                <li class="active">
                  <a href="#">1</a>
                </li>
                <li class="disabled">
                  <a href="#">&raquo;</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="container">
      <div class="row-fluid">
        <div class="span2 offset1">
          <h4>Navigate</h4>
          <ul>
            <li>
              <a href=".." title="Overview">Overview</a>
            </li>
            <li>
              <a href="../download" title="Download">Download</a>
            </li>
            <li>
              <a href="../usage" title="Usage">Usage</a>
            </li>
          </ul>
        </div>
        <div class="span2">
          <h4>Follow Us</h4>
          <ul>
            <li>
              <a href="../blog" title="Blog">Blog</a>
            </li>
            <li>
              <a href="http://twitter.com/jbosstools" title="Twitter">Twitter</a>
            </li>
            <li>
              <a href="https://plus.google.com/109915195368578219327" title="Google+">Google+</a>
            </li>
          </ul>
        </div>
        <div class="span2">
          <h4>Contribute</h4>
          <ul>
            <li>
              <a href="https://issues.jboss.org/browse/JBIDE" title="Submit a bug">Submit a bug</a>
            </li>
            <li>
              <a href="https://github.com/jbosstools" title="Write code">Write Code</a>
            </li>
            <li>
              <a href="#" title="Ask questions on the forum">Ask questions on the forum</a>
            </li>
            <li>
              <a href="#" title="Talk on IRC">Talk with us on IRC</a>
            </li>
          </ul>
        </div>
        <div class="span3 offset1">
          <h4>Licenses</h4>
          <p>All plugins are available under the Eclipse Public License (EPL).</p>
          <p>They may also contain some libraries licensed under certain open source licenses such as EPL, LGPL, and/or certain other open source licenses.</p>
          <p></p>
          <div class="jbossbadge">
            <a href="http://www.jboss.org/">
              <img src="http://static.jboss.org/theme/images/common/jbossbadge.png">
            </a>
          </div>
        </div>
      </div>
    </footer>
    <div class="container" id="companyfooter">
      <div class="redhatlogo">
        <div id="logospacer"></div>
        <a href="http://www.redhat.com/"><img src="http://static.jboss.org/theme/images/common/redhat_logo.png"></a>
      </div>
    </div>
    <span class="backToTop">
      <a href="#top">back to top</a>
    </span>
    <script src="http://static.jboss.org/theme/js/libs/bootstrap-community/2.3.1.3/bootstrap-community.js"></script>
  </body>
</html>
